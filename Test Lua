-- TriggerBot by ArchScrim - Optimisé pour Da Hood

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- === CONFIGURATION ===
local TRIGGER_KEY = Enum.KeyCode.C
local MENU_KEY = Enum.KeyCode.RightControl
local SHOOT_DELAY = 0.03 -- 30 ms
local MAX_DISTANCE = 15 -- pixels entre curseur et cible

local predictionTime = 0.03
local BodyParts = {"Head", "UpperTorso", "LowerTorso", "HumanoidRootPart", "LeftArm", "RightArm", "LeftLeg", "RightLeg"}

-- === VARIABLES ===
local TriggerEnabled = false
local LastShot = 0
local MenuVisible = true

-- === GUI ===
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "TriggerBotMenu"

local Frame = Instance.new("Frame", ScreenGui)
Frame.Position = UDim2.new(0, 20, 0, 100)
Frame.Size = UDim2.new(0, 200, 0, 100)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.BorderSizePixel = 0
Frame.Visible = true

local Title = Instance.new("TextLabel", Frame)
Title.Size = UDim2.new(1, 0, 0, 25)
Title.Text = "TriggerBot (By ArchScrim)"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 18

local StatusLabel = Instance.new("TextLabel", Frame)
StatusLabel.Position = UDim2.new(0, 0, 0, 40)
StatusLabel.Size = UDim2.new(1, 0, 0, 25)
StatusLabel.Text = "Status: OFF"
StatusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Font = Enum.Font.SourceSans
StatusLabel.TextSize = 18

-- === TOGGLE FUNCTION ===
function ToggleTrigger()
	TriggerEnabled = not TriggerEnabled
	StatusLabel.Text = "Status: " .. (TriggerEnabled and "ON" or "OFF")
	StatusLabel.TextColor3 = TriggerEnabled and Color3.fromRGB(80, 255, 80) or Color3.fromRGB(255, 80, 80)
end

-- === PREDICTION ===
local function Predict(part)
	if not part then return nil end
	local velocity = part.Velocity
	return part.Position + (velocity * predictionTime)
end

-- === CHECK TARGET VALIDITY ===
local function IsValidTarget(char)
	local hum = char:FindFirstChildOfClass("Humanoid")
	if not hum or hum.Health < 5 then return false end

	local root = char:FindFirstChild("HumanoidRootPart")
	if not root then return false end

	local origin = Camera.CFrame.Position
	local direction = (root.Position - origin).Unit * 1000

	local ray = RaycastParams.new()
	ray.FilterType = Enum.RaycastFilterType.Blacklist
	ray.FilterDescendantsInstances = {LocalPlayer.Character, char}

	local result = workspace:Raycast(origin, direction, ray)
	if result and result.Instance and not char:IsAncestorOf(result.Instance) then
		return false -- bloqué par un mur
	end

	return true
end

-- === TRIGGER LOOP ===
RunService.Heartbeat:Connect(function()
	if not TriggerEnabled then return end
	if tick() - LastShot < SHOOT_DELAY then return end

	local mousePos = UIS:GetMouseLocation()
	local closest, closestDist = nil, MAX_DISTANCE

	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= LocalPlayer and plr.Character and IsValidTarget(plr.Character) then
			for _, partName in ipairs(BodyParts) do
				local part = plr.Character:FindFirstChild(partName)
				if part then
					local predicted = Predict(part)
					local screenPos, onScreen = Camera:WorldToViewportPoint(predicted)
					if onScreen then
						local dist = (Vector2.new(screenPos.X, screenPos.Y) - Vector2.new(mousePos.X, mousePos.Y)).Magnitude
						if dist < closestDist then
							closest = part
							closestDist = dist
						end
					end
				end
			end
		end
	end

	if closest then
		mouse1press()
		mouse1release()
		LastShot = tick()
	end
end)

-- === TOGGLE INPUTS ===
UIS.InputBegan:Connect(function(input, gpe)
	if gpe then return end

	if input.KeyCode == TRIGGER_KEY then
		ToggleTrigger()
	elseif input.KeyCode == MENU_KEY then
		MenuVisible = not MenuVisible
		Frame.Visible = MenuVisible
	end
end)

-- === NOTIFICATION ===
local StarterGui = game:GetService("StarterGui")
StarterGui:SetCore("SendNotification", {
	Title = "TriggerBot",
	Text = "Script lancé - By ArchScrim",
	Duration = 4
})
